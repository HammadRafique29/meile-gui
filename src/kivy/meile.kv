#: import SlideTransition kivy.uix.screenmanager.SlideTransition
#: import get_color_from_hex kivy.utils.get_color_from_hex

WindowManager:


<MainWindow>:
    name: "main"
    MDBoxLayout:
        orientation: 'vertical'
        
        MDToolbar:
            id: toolbar
            title: "Sentinel dVPN"
            md_bg_color: get_color_from_hex("#0d021b")
            height: "100dp"
            
            MDRaisedButton:
                id: wallet_button
                text: "Wallet"
                pos_hint: {"center_x": .5, "center_y": .5}
                on_press: root.wallet_dialog()
                
            FitImage:
                source: "./src/imgs/logo.png"
                size_hint: None, None
                height: "100dp"
                pos: self.pos
    
        
        MDTabs:
            id: android_tabs
            on_tab_switch: root.on_tab_switch(*args)
            size_hint_y: None
            height: "48dp"
            tab_indicator_anim: True
            color: 0,0,0,1
            background_color: 0,0,0,1
        
        
        NodeRV:
            id: rv
            

        MDSpinner:
            id: spinnuh
            height: dp(23)
            size_hint: None, None
            size: dp(23), dp(23)
            pos_hint: {'center_x': .5, 'center_y': .5}
            active: False
            opacity: 0
                   
    

            
<NodeRV>:
    key_viewclass: "viewclass"
    RecycleGridLayout:
        cols:1
        default_size: dp(200), dp(180)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: 'lr-tb' 


        
<-FullImage>:
    canvas:
        Rectangle:
            texture: self.texture
            size: self.width-45 , self.height +30
            pos: self.x - 150, self.y - 30             
<-FullImage2>:
    canvas:
        Rectangle:
            texture: self.texture
            size: self.width - 170, self.height -25
            pos: self.x + 80 , self.y           
                
<RecycleViewRow>:
    size_hint_y: None
    size: "180dp", "180dp"
    pos_hint: {"center_x": .5, "center_y": .5}
    orientation: "vertical"
    padding: 10
    border_radius: 20
    radius: [15]
    elevation:0
    md_bg_color: get_color_from_hex("#0d021b")
    moniker_text: "."
    country_text: "."
    price_text: "."
    address_text: "."
    city_text: " "
    source_image: " "
    speed_image: " "
    speed_text: " "
    focus_behavior: True
    ripple_behavior: True
    on_press: root.subscribe_to_node(root.price_text, root.address_text, root.moniker_text)
    MDGridLayout:
        cols: 3
        rows: 2
        padding: 40,0,0,0
        MDLabel:
            text: root.moniker_text
            theme_text_color: "Custom"
            font_style: "H6"
            font_size: "24sp"
            text_color: get_color_from_hex("#fcb711")
            width: "350dp"
            size_hint_x: None
        FullImage:
            source: root.source_image
            
        MDLabel:    
            text: root.country_text
            theme_text_color: "Custom"
            font_style: "H6"
            font_size: "22sp"
            text_color: (1,1,1,1)  
        MDLabel:
            text: root.address_text
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "9sp"
            text_color: (0/255.0,141/255.0,155/255.0,255/255.0)
        MDLabel:
            text: " "
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "14sp"
            text_color: (0/255.0,141/255.0,155/255.0,255/255.0)
        MDLabel:
            text: " "
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "14sp"
            text_color: (0/255.0,141/255.0,155/255.0,255/255.0)                                    
    MDGridLayout:
        cols: 3
        padding: 40,0,0,0
        MDLabel:
            text: root.price_text
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "14sp"
            text_color: get_color_from_hex("#fcb711")
        FullImage2:
            source: root.speed_image
        MDBoxLayout:
            padding: 80,30,0,0
            MDLabel:
                text: root.speed_text
                theme_text_color: "Custom"
                font_style: "Subtitle2"
                font_size: "12sp"
                text_color: 1,1,1,1
                



    MDRaisedButton:
        text: "Get Details"
        md_bg_color: get_color_from_hex("#fcb711")
        text_color: 0,0,0,1
        on_press: root.get_city_of_node(root.address_text)
        
        
    MDSeparator:
        color: 1,1,1,1

<RecycleViewSubRow>:
    size_hint_y: None
    size: "180dp", "180dp"
    pos_hint: {"center_x": .5, "center_y": .5}
    orientation: "vertical"
    padding: 10
    border_radius: 20
    radius: [15]
    elevation:0
    md_bg_color: get_color_from_hex("#0d021b")
    moniker_text: "."
    sub_id_text: " "
    country_text: "."
    price_text: "."
    address_text: "."
    city_text: " "
    allocated_text: "10GB"
    consumed_text: "10GB"
    source_image: " "
    speed_image: " "
    speed_text: " "
    MDGridLayout:
        cols: 3
        rows: 2
        padding: 40,0,0,0
        MDLabel:
            text: root.moniker_text
            theme_text_color: "Custom"
            font_style: "H6"
            font_size: "24sp"
            text_color: get_color_from_hex("#fcb711")
            width: "350dp"
            size_hint_x: None
        FullImage:
            source: root.source_image
            
        MDLabel:    
            text: root.country_text
            theme_text_color: "Custom"
            font_style: "H6"
            font_size: "22sp"
            text_color: (1,1,1,1)  
        MDLabel:
            text: root.address_text
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "9sp"
            text_color: (0/255.0,141/255.0,155/255.0,255/255.0)
        MDLabel:
            text: root.sub_id_text
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "14sp"
            text_color: (0/255.0,141/255.0,155/255.0,255/255.0)
        MDLabel:
            text: " "
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "14sp"
            text_color: (0/255.0,141/255.0,155/255.0,255/255.0)                                    
    MDGridLayout:
        cols: 2
        rows: 2
        padding: 40,0,0,0
        MDLabel:
            text: root.price_text
            theme_text_color: "Custom"
            font_style: "Subtitle2"
            font_size: "14sp"
            text_color: get_color_from_hex("#fcb711")
        MDBoxLayout:
            padding: 80,30,0,0
            MDLabel:
                text: root.allocated_text
                theme_text_color: "Custom"
                font_style: "Subtitle2"
                font_size: "12sp"
                text_color: 1,1,1,1
            MDLabel:
                text: root.consumed_text
                theme_text_color: "Custom"
                font_style: "Subtitle2"
                font_size: "12sp"
                text_color: 1,1,1,1
        MDProgressBar:
            value: root.get_data_used(root.allocated_text, root.consumed_text)
            back_color: get_color_from_hex("#ffffff")
                



    MDRaisedButton:
        text: "Connect"
        md_bg_color: get_color_from_hex("#fcb711")
        text_color: 0,0,0,1
        on_press: root.get_city_of_node(root.address_text)
        
        
    MDSeparator:
        color: 1,1,1,1
         
<MySeedBox>

<ClickableTextFieldRoundSeed>:
    size_hint_y: None
    height: seed_phrase.height

    MDTextField:
        id: seed_phrase
        hint_text: root.hint_text
        text: root.text
        password: False
        icon_left: "key-variant"
        mode: "rectangle"

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_y": .5}
        pos: seed_phrase.width - self.width + dp(8), 0
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            seed_phrase.password = False if seed_phrase.password is True else True


<ClickableTextFieldRoundName>:
    size_hint_y: None
    height: wallet_name.height

    MDTextField:
        id: wallet_name
        hint_text: root.hint_text
        text: root.text
        password: False
        icon_left: "key-variant"
        mode: "rectangle"

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_y": .5}
        pos: wallet_name.width - self.width + dp(8), 0
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            wallet_name.password = False if wallet_name.password is True else True
            
<ClickableTextFieldRoundPass>:
    size_hint_y: None
    height: wallet_password.height

    MDTextField:
        id: wallet_password
        hint_text: root.hint_text
        text: root.text
        password: False
        icon_left: "key-variant"
        mode: "rectangle"

    MDIconButton:
        icon: "eye-off"
        pos_hint: {"center_y": .5}
        pos: wallet_password.width - self.width + dp(8), 0
        theme_text_color: "Hint"
        on_release:
            self.icon = "eye" if self.icon == "eye-off" else "eye-off"
            wallet_password.password = False if wallet_password.password is True else True


<WalletRestore>:
    name: "walletrestore"
    title: app.title
    ActionBar:
        ActionView:
            ActionPrevious:
                title: 'Go Back'
                with_previous: True
                on_release: root.set_previous_screen(None) 
    
    
    ClickableTextFieldRoundSeed:
        id: seed
        size_hint_x: None
        width: "300dp"
        height: "300dp"
        hint_text: "Seed Phrase"
        pos_hint: {"center_x": .5, "center_y": .80}
     
    ClickableTextFieldRoundName:
        id: name
        size_hint_x: None
        width: "300dp"
        height: "300dp"
        hint_text: "Wallet Name"
        pos_hint: {"center_x": .5, "center_y": .70}
    
    ClickableTextFieldRoundPass:
        id: password
        size_hint_x: None
        width: "300dp"
        height: "300dp"
        hint_text: "Wallet Password"
        pos_hint: {"center_x": .5, "center_y": .60}
    
        
    MDRaisedButton:
        id: restore_wallet_button
        text: "Restore"
        pos_hint: {"center_x": .5, "center_y": .5}
        on_press: root.restore_wallet_from_seed_phrase()
    
    
<PreLoadWindow>:
    name: "preload"
    status_text: "Loading..."
    title: app.title
    MDBoxLayout:
        md_bg_color: 0,0,0,1
        orientation: "vertical"
        AnchorLayout:
            anchor_x: 'center'
            anchor_y: 'center'
    
            Image:
                source: "./src/imgs/logo_hd.png"
                size_hint: None, None
                size: 400, 400
                # size: self.texture_size[0] / 2, self.texture_size[1] / 2
                # opacity: 0.1
        
        MDLabel:
            id: status_label
            bold: True
            text: root.status_text
            color: 1,1,1,1
            halign: "center"
            pos_hint: {"center_x": .5, "center_y": .5}

        MDRaisedButton:
            id: go_button
            opacity: 0
            disabled: True
            text: "Let's Go"
            pos_hint: {"center_x": .5, "center_y": .5}
            on_press: root.switch_window()

<Tab>

<SelectableLabel>:
    # Draw a background to indicate selection
    text1: "GLARGLY"
    text2: "BLARGLY"
    text3: "SHIMARGLY"
    canvas.before:

        Color:
            rgba: (.0, 0.9, .1, .3) if self.selected else (0, 0, 0, 1)
        Rectangle:
            pos: self.pos
            size: self.size

<RV>:
    viewclass: 'SelectableLabel'
    RecycleBoxLayout:
        default_size: None, dp(48)
        default_size_hint: 1, None
        size_hint_y: None
        height: self.minimum_height
        orientation: "vertical"

<MD3Card>
    
    orientation: "vertical"
    height: node_box.height 
    focus_behavior: True
    ripple_behavior: True

    moniker_text:  "BLARGLY"
    moniker2_text: "GLARGLY"
    moniker3_text: "SHLARMLY"
    moniker4_text: "GBILAGY"
    on_release: root.show_alert_dialog()
    source_image: "TESST"
    speed_image: "FAZSAT"
    background_color: 98.8,71.8,6.7,1

    FloatLayout:
        id: node_box
        size_hint_y: None
        height: "50dp"
    
        canvas:
            Rectangle:
                pos: self.pos
                size: self.size
        FitImage:
            source: root.source_image
            size_hint: None, None
            height: "30dp"
            width: "50dp"
         
        MDLabel:
            id: label_box
            bold: True
            text: root.moniker_text
            pos: 60,0
        MDLabel:
            id: label_box
            font_size: "10dp"
            text: root.moniker2_text
            pos: 60,20
        MDLabel:
            id: label_box
            font_size: "10dp"
            text: root.moniker3_text
            pos: 120,20
        FitImage:
            source: root.speed_image
            size_hint: None, None
            height: "30dp"
            width: "40dp"
            pos: 150, 0 
            
        MDLabel:
            id: label_box
            font_size: "7dp"
            text_size: 50,10
            text: root.moniker4_text
            pos: 180,20
                       


        
    MDSeparator:
    

<SubscribeContent>
    orientation: "vertical"
    spacing: "5dp"
    size_hint_y: None
    height: "180dp"
    price_text: "1dvpn"
    MDBoxLayout:
        orientation: "horizontal"
        MDSlider:
            
            id: slider1
            min: 1
            max: 314
            value: 40
            
        MDLabel:
            text: str(int(slider1.value)) + " GB" 
            size_hint_x: None
            width: 75
    MDBoxLayout:
        orientation: "horizontal"
        size_hint_x: .8
        spacing: 20
        
        MDTextField:
            id: deposit
            hint_text: "Deposit"
            mode: "fill"
            text: str(round(int(slider1.value)*int(glargy.text.split('udvpn')[0])/1000000,3)) + "dvpn/GB"
            size_hint_y: .65
            width: "50dp"
            height: "30dp"
            readonly: True
        
        MDTextField:
            id: glargy
            hint_text: "Price"
            mode: "fill"
            text: root.price_text
            size_hint_y: .65
            width: "50dp"
            height: "30dp"
            readonly: True
        
    


